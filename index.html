<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Invoice Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #22c55e;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .slider.round {
            border-radius: 34px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Order Invoice Tracker</h1>

        <div class="mb-4 flex justify-between items-center">
            <input type="text" id="newOrderNumber" placeholder="Enter Order Number" class="flex-grow mr-4 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button id="addOrderBtn" class="bg-blue-600 text-white font-medium py-2 px-6 rounded-lg shadow hover:bg-blue-700 transition-colors">Add Order</button>
        </div>

        <div class="overflow-x-auto rounded-xl shadow">
            <table class="min-w-full bg-white rounded-xl">
                <thead class="bg-gray-200">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider rounded-tl-xl">Order Number</th>
                        <th class="px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider rounded-tr-xl">Invoice Sent</th>
                    </tr>
                </thead>
                <tbody id="orderTableBody" class="divide-y divide-gray-200">
                    <!-- Table rows will be inserted here by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const addOrderBtn = document.getElementById('addOrderBtn');
            const newOrderNumberInput = document.getElementById('newOrderNumber');
            const orderTableBody = document.getElementById('orderTableBody');

            // Load from localStorage on page load
            let orders = JSON.parse(localStorage.getItem('orders')) || [];

            const renderTable = () => {
                orderTableBody.innerHTML = ''; // Clear existing rows
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50';
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${order.orderNumber}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <label class="toggle-switch">
                                <input type="checkbox" ${order.invoiceSent ? 'checked' : ''} data-order-number="${order.orderNumber}">
                                <span class="slider round"></span>
                            </label>
                        </td>
                    `;
                    orderTableBody.appendChild(row);
                });

                // Attach event listeners to new toggles
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const orderNumber = e.target.dataset.orderNumber;
                        const isChecked = e.target.checked;
                        updateInvoiceStatus(orderNumber, isChecked);
                    });
                });
            };

            const addOrder = () => {
                const orderNumber = newOrderNumberInput.value.trim();
                if (orderNumber) {
                    const existingOrder = orders.find(o => o.orderNumber === orderNumber);
                    if (!existingOrder) {
                        orders.push({ orderNumber, invoiceSent: false });
                        saveOrders();
                        renderTable();
                        newOrderNumberInput.value = '';
                    } else {
                        // Use a custom message box instead of alert
                        showMessageBox("Order number already exists!", "error");
                    }
                } else {
                    showMessageBox("Please enter an order number.", "info");
                }
            };

            const updateInvoiceStatus = (orderNumber, isChecked) => {
                const orderIndex = orders.findIndex(o => o.orderNumber === orderNumber);
                if (orderIndex !== -1) {
                    orders[orderIndex].invoiceSent = isChecked;
                    saveOrders();
                }
            };

            const saveOrders = () => {
                localStorage.setItem('orders', JSON.stringify(orders));
            };

            // Custom message box function to replace alert()
            const showMessageBox = (message, type = 'info') => {
                // Check if a message box already exists and remove it to avoid duplicates
                let msgBox = document.getElementById('custom-message-box');
                if (msgBox) {
                    msgBox.remove();
                }

                const colorClasses = {
                    info: 'bg-blue-500',
                    error: 'bg-red-500',
                    success: 'bg-green-500'
                };

                const messageBoxDiv = document.createElement('div');
                messageBoxDiv.id = 'custom-message-box';
                messageBoxDiv.className = `fixed bottom-5 left-1/2 -translate-x-1/2 z-50 p-4 rounded-lg shadow-xl text-white font-semibold transition-transform transform-gpu duration-300 ease-in-out scale-0 ${colorClasses[type]}`;
                messageBoxDiv.textContent = message;

                document.body.appendChild(messageBoxDiv);

                // Animate the message box in
                setTimeout(() => {
                    messageBoxDiv.style.transform = 'translate(-50%, 0) scale(1)';
                }, 10);

                // Animate the message box out after a delay
                setTimeout(() => {
                    messageBoxDiv.style.transform = 'translate(-50%, 0) scale(0)';
                    setTimeout(() => {
                        messageBoxDiv.remove();
                    }, 300); // Remove after the transition is complete
                }, 3000); // Display for 3 seconds
            };

            addOrderBtn.addEventListener('click', addOrder);
            newOrderNumberInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addOrder();
                }
            });

            // Initial render
            renderTable();
        });
    </script>

</body>
</html>
